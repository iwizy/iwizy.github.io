---
sidebar_position: 4
slug: /types/nosql/db-tsdb
---

# Базы данных временных рядов

Базы данных временных рядов (time series databases, TSDB) предназначены для эффективного хранения, обработки и анализа данных, которые упорядочены по времени. Такие базы данных оптимизированы для работы с временными рядами и предоставляют возможности для анализа временных изменений, прогнозирования и обработки больших объемов данных.

## Особенности временных рядов

Временной ряд представляет собой набор данных, где каждое значение связано с временной меткой. Примеры таких данных:

- Измерения температуры на протяжении времени.
- Лог-файлы серверов (временная метка + событие).
- Уровень потребления электроэнергии.
- Биржевые котировки и финансовые метрики.

## Основные задачи временных рядов

1. **Хранение данных**: Быстрое добавление новых записей с минимальными затратами на хранение.
2. **Агрегация**: Подсчет среднего, максимального, минимального значений за заданный период.
3. **Поиск по времени**: Быстрая выборка данных за указанный временной интервал.
4. **Анализ трендов**: Обнаружение паттернов, прогнозирование будущих значений.
5. **Обработка пропусков**: Автоматическое восстановление пропущенных значений.

## Преимущества TSDB

1. Оптимизация под временные ряды: эффективное хранение и индексация.
2. Поддержка временных операций, таких как:
   - Скользящее среднее.
   - Накопительные суммы.
   - Интерполяция данных.
3. Высокая производительность при записи большого объема данных.
4. Гибкость масштабирования: многие TSDB поддерживают горизонтальное масштабирование.

## Популярные базы данных временных рядов

### InfluxDB

   - Язык запросов: InfluxQL (похож на SQL).
   - Преимущества: высокая производительность, поддержка тегов для упрощения фильтрации.
   - Используется для мониторинга серверов, IoT, анализа данных.

   **Пример записи:**

   ```
   temperature,location=room1 value=22.5 1672502400
   ```

### TimescaleDB

   - Построена поверх PostgreSQL.
   - Поддерживает SQL и стандартные операции PostgreSQL.
   - Простота интеграции с существующими проектами.
   - Используется для мониторинга приложений, анализа финансовых данных.

   **Пример запроса:**

   ```sql
   SELECT time_bucket('1 hour', timestamp) AS bucket,
          AVG(value) AS avg_value
   FROM temperature
   WHERE timestamp > now() - interval '1 day'
   GROUP BY bucket;
   ```

###  OpenTSDB

   - Основана на HBase (NoSQL).
   - Отлично подходит для работы с большими объемами данных.
   - Используется для систем мониторинга, например, в крупных дата-центрах.

   **Пример команды записи:**

   ```
   put sys.cpu.load 1672502400 0.65 host=server1
   ```

### Prometheus

   - Основной инструмент для мониторинга и оповещения.
   - Поддерживает язык запросов PromQL.
   - Фокус на метриках и временных рядах для DevOps.

   **Пример запроса:**

   ```
   avg_over_time(cpu_usage[5m])
   ```

### Graphite

   - Простота в использовании.
   - Чаще применяется для мониторинга и визуализации метрик.

## Применение временных рядов

1. **Интернет вещей (IoT)**:
   - Датчики температуры, влажности, освещенности.
   - Устройства умного дома.

2. **Мониторинг инфраструктуры**:
   - Производительность серверов.
   - Состояние сетей.

3. **Финансовая аналитика**:
   - Биржевые данные.
   - Анализ доходов.

4. **Научные исследования**:
   - Метеорологические данные.
   - Измерения в физике и биологии.

## Советы по выбору TSDB

1. **Тип данных**: Убедитесь, что база данных поддерживает нужные типы данных и объемы.
2. **Интеграция**: Выбирайте TSDB, совместимую с существующей инфраструктурой.
3. **Скорость записи/чтения**: Важна для систем реального времени.
4. **Функциональность**: Наличие необходимых аналитических инструментов.
