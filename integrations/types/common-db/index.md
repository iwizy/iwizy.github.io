---
sidebar_position: 3
slug: /types/common-db
---

# Общая база данных

Интеграция с помощью общей базы данных предполагает, что несколько приложений или систем обмениваются данными через одну центральную базу данных (БД). Этот подход позволяет синхронизировать данные между разными системами, обеспечивать их целостность и актуальность. Вот подробное объяснение с примерами:

## Принципы работы интеграции через общую БД

1. **Централизованное хранилище данных:** Все приложения используют одну БД как источник и хранилище информации.
2. **Единый формат данных:** Все системы договариваются о структуре таблиц, полей и типов данных, чтобы избежать конфликтов.
3. **Управление транзакциями:** Данные обновляются с использованием транзакций для предотвращения потери или несогласованности информации.
4. **Единые права доступа:** Каждое приложение имеет свои учетные данные для доступа к БД с четко определенными правами (например, только чтение, запись и т. д.).

## Преимущества

- **Синхронизация данных:** Все системы имеют доступ к актуальной версии данных.
- **Снижение сложности интеграции:** Не нужно создавать сложные API или шины данных.
- **Повышение производительности:** Уменьшается необходимость в промежуточных уровнях передачи данных.
- **Единая точка администрирования:** Управление данными централизовано.

## Недостатки

- **Единая точка отказа:** Если база данных недоступна, все системы перестают функционировать.
- **Сложность масштабирования:** При увеличении нагрузки может потребоваться серьезная оптимизация.
- **Риск некорректного использования:** Если приложения не согласованы в использовании структуры БД, возможны конфликты.
- **Повышенные требования к безопасности:** Все данные хранятся в одном месте, что делает БД мишенью для атак.

## Примеры использования

### Пример 1: CRM и ERP системы

Компания использует две системы:

- **CRM:** Для управления клиентами, включая их контакты, историю взаимодействий и заказы.
- **ERP:** Для управления складом, закупками и бухгалтерией.

**Интеграция через общую БД:**

- Таблица `customers` хранит информацию о клиентах.
- Таблица `orders` хранит информацию о заказах.
- CRM обновляет таблицу `customers` при добавлении новых клиентов.
- ERP использует таблицу `orders` для учета остатков на складе.

*Взаимодействие:* Когда менеджер CRM создает заказ в таблице `orders`, ERP немедленно видит этот заказ и может обновить складские остатки.

### Пример 2: Интернет-магазин

Интернет-магазин работает через веб-приложение и мобильное приложение.

**Общая БД:**

- Таблица `products`: Содержит информацию о товарах.
- Таблица `users`: Содержит информацию о пользователях.
- Таблица `orders`: Хранит данные о заказах.

*Взаимодействие:*

- Веб-приложение обновляет цены в таблице `products`.
- Мобильное приложение читает эту же таблицу, показывая актуальные цены.
- Когда пользователь делает заказ в мобильном приложении, данные записываются в таблицу `orders`, а веб-приложение тут же отображает обновленный список заказов.

## Технические аспекты

### Архитектура БД

База данных может быть реляционной (например, MySQL, PostgreSQL) или нереляционной (например, MongoDB, Cassandra).

### Механизмы синхронизации

- **Триггеры:** Например, при добавлении строки в таблицу `orders`, обновляется таблица `inventory`.
- **Хранимые процедуры:** Логика обработки данных может быть реализована в самой БД.
- **Просмотры (views):** Для упрощения доступа к данным из разных систем.

### Распределение прав доступа

Каждое приложение получает доступ только к тем таблицам и полям, которые ему необходимы. Например:

- CRM имеет права на запись в таблицу `customers`, но только чтение для `orders`.
- ERP имеет права на запись в `orders` и `inventory`, но не на `customers`.

## Пример SQL

```sql
-- Создание таблицы клиентов
CREATE TABLE customers (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    phone VARCHAR(15)
);

-- Создание таблицы заказов
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    customer_id INT REFERENCES customers(id),
    order_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    total DECIMAL(10, 2) NOT NULL
);

-- Вставка данных
INSERT INTO customers (name, email, phone)
VALUES ('Иван Иванов', 'ivanov@example.com', '+79990001122');

INSERT INTO orders (customer_id, total)
VALUES (1, 1500.00);

-- Получение всех заказов с клиентами
SELECT o.id AS order_id, c.name AS customer_name, o.total
FROM orders o
JOIN customers c ON o.customer_id = c.id;
```

Интеграция через общую БД подходит для систем, которые тесно связаны и требуют постоянной синхронизации данных. Однако важно учитывать ограничения и тщательно проектировать структуру данных, чтобы избежать проблем в будущем.
