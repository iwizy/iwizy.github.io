---
sidebar_position: 1
slug: /normalization/nf
---

# Нормальные формы

Нормализация базы данных — это процесс структурирования данных в реляционной базе для минимизации избыточности и предотвращения аномалий при вставке, обновлении или удалении данных. Этот процесс делится на несколько этапов, называемых **нормальными формами (НФ)**. Каждая последующая форма накладывает дополнительные ограничения.

## Первая нормальная форма (1НФ)

Таблица находится в **1НФ**, если:

1. **Все значения атомарны**: каждое поле содержит только одно значение, а не набор данных (например, списки или массивы).
2. **Каждая строка уникальна**: в таблице должен быть идентификатор (первичный ключ).
3. **Отсутствуют повторяющиеся группы**: значения не должны быть организованы в массивы или многозначные поля.

### Пример

**Таблица до нормализации (ненормализованная):**

| ID  | Имя    | Телефоны          |
|------|--------|-------------------|
| 1    | Иван   | 123, 456         |
| 2    | Анна   | 789              |

**Проблема:** Столбец "Телефоны" содержит несколько значений в одной ячейке. Это нарушает принцип атомарности.

**Таблица после нормализации (в 1НФ):**

| ID  | Имя    | Телефон |
|------|--------|---------|
| 1    | Иван   | 123     |
| 1    | Иван   | 456     |
| 2    | Анна   | 789     |

Теперь каждая ячейка таблицы содержит только одно значение.

## Вторая нормальная форма (2НФ)

Таблица находится во **2НФ**, если:

1. Она находится в 1НФ.
2. Все неключевые атрибуты (поля, которые не являются частью первичного ключа) зависят от **всего** первичного ключа, а не только от его части (в случае составного ключа).

### Пример

**Таблица, не находящаяся во 2НФ:**

| КурсID | СтудентID | КурсНазвание | СтудентИмя |
|--------|-----------|--------------|------------|
| 1      | 101       | Математика   | Иван       |
| 1      | 102       | Математика   | Анна       |
| 2      | 101       | Физика       | Иван       |

**Проблема:**

- `КурсНазвание` зависит только от `КурсID`.
- `СтудентИмя` зависит только от `СтудентID`.
- Эти зависимости не относятся ко всему составному ключу (`КурсID` + `СтудентID`).

**Таблица после нормализации (во 2НФ):**

1. **Таблица Курсы:**

| КурсID | КурсНазвание |
|--------|--------------|
| 1      | Математика   |
| 2      | Физика       |

1. **Таблица Студенты:**
   
| СтудентID | СтудентИмя |
|-----------|------------|
| 101       | Иван       |
| 102       | Анна       |

1. **Таблица Связей:**

| КурсID | СтудентID |
|--------|-----------|
| 1      | 101       |
| 1      | 102       |
| 2      | 101       |

Теперь каждая таблица содержит данные, полностью зависящие от своего первичного ключа.

## Третья нормальная форма (3НФ)

Таблица находится в **3НФ**, если:

1. Она находится во 2НФ.
2. У неключевых полей нет транзитивной зависимости от первичного ключа (неключевое поле зависит только от первичного ключа, а не от другого неключевого поля).

### Пример

**Таблица, не находящаяся в 3НФ:**

| СтудентID | СтудентИмя | ГородID | ГородНазвание |
|-----------|------------|---------|---------------|
| 101       | Иван       | 1       | Москва        |
| 102       | Анна       | 2       | Санкт-Петербург |

**Проблема:** Поле `ГородНазвание` зависит не от `СтудентID`, а от `ГородID`. Это транзитивная зависимость.

**Таблица после нормализации (в 3НФ):**

1. **Таблица Студенты:**

| СтудентID | СтудентИмя | ГородID |
|-----------|------------|---------|
| 101       | Иван       | 1       |
| 102       | Анна       | 2       |

1. **Таблица Города:**

| ГородID | ГородНазвание    |
|---------|------------------|
| 1       | Москва           |
| 2       | Санкт-Петербург  |

Теперь каждая таблица содержит данные, которые зависят только от её собственного ключа.

## Бойс-Кодд нормальная форма (BCNF)

Таблица находится в **BCNF**, если:

1. Она находится в 3НФ.
2. Каждый детерминант (поле, от которого зависят другие) является кандидатом на первичный ключ.

### Пример

**Таблица, не находящаяся в BCNF:**

| КурсID | Преподаватель | Аудитория |
|--------|---------------|-----------|
| 1      | Иванов        | 101       |
| 2      | Петров        | 102       |
| 1      | Иванов        | 103       |

**Проблема:** Поле `Преподаватель` определяет `Аудиторию`, но `Преподаватель` не является ключом.

**Таблица после нормализации (в BCNF):**

1. **Таблица Преподаватели и Аудитории:**

| Преподаватель | Аудитория |
|---------------|-----------|
| Иванов        | 101       |
| Петров        | 102       |

1. **Таблица Курсы:**

| КурсID | Преподаватель |
|--------|---------------|
| 1      | Иванов        |
| 2      | Петров        |

Теперь каждая зависимость соответствует ключевому правилу.

## Четвёртая нормальная форма (4НФ)

Таблица находится в **4НФ**, если:

1. Она находится в BCNF.
2. Отсутствуют многозначные зависимости между атрибутами.

### Пример

**Таблица, не находящаяся в 4НФ:**

| СтудентID | Курс       | Хобби      |
|-----------|------------|------------|
| 101       | Математика | Футбол     |
| 101       | Математика | Шахматы    |

**Проблема:** У студента одновременно несколько курсов и хобби, что создаёт избыточность.

**Таблица после нормализации (в 4НФ):**

1. **Таблица СтудентыКурсы:**

| СтудентID | Курс       |
|-----------|------------|
| 101       | Математика |

1. **Таблица СтудентыХобби:**

| СтудентID | Хобби      |
|-----------|------------|
| 101       | Футбол     |
| 101       | Шахматы    |

Теперь каждая зависимость разделена.

## Пятая нормальная форма (5НФ)

Таблица находится в **5НФ**, если:

1. Она находится в 4НФ.
2. Данные нельзя разделить на меньшие таблицы без потери информации. Все зависимости представляются только через соединение.

### Пример

Представьте таблицу, содержащую тройное отношение:

| ПроектID | РаботникID | НавыкID |
|----------|------------|---------|
| 1        | 101        | Java    |
| 1        | 102        | Python  |

Эта таблица должна быть разделена на три таблицы (связи "многие ко многим") без потери данных:

1. **Таблица Проекты и Работники.**
2. **Таблица Работники и Навыки.**
3. **Таблица Проекты и Навыки.**

## Итог

- **1НФ**: Устраняет неатомарные значения.
- **2НФ**: Устраняет частичные зависимости.
- **3НФ**: Устраняет транзитивные зависимости.
- **BCNF**: Устраняет нарушения, когда детерминанты не являются ключами.
- **4НФ**: Устраняет многозначные зависимости.
- **5НФ**: Устраняет проблемы проекции и соединения.

Нормализация позволяет минимизировать избыточность и повысить целостность данных, однако чрезмерная нормализация может снижать производительность при выполнении запросов.
